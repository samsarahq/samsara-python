# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.media_retrieval_get_media_retrieval_response_body import MediaRetrievalGetMediaRetrievalResponseBody
from ..types.media_retrieval_list_uploaded_media_response_body import MediaRetrievalListUploadedMediaResponseBody
from ..types.media_retrieval_post_media_retrieval_response_body import MediaRetrievalPostMediaRetrievalResponseBody
from .raw_client import AsyncRawMediaClient, RawMediaClient
from .types.list_uploaded_media_request_inputs_item import ListUploadedMediaRequestInputsItem
from .types.list_uploaded_media_request_media_types_item import ListUploadedMediaRequestMediaTypesItem
from .types.list_uploaded_media_request_trigger_reasons_item import ListUploadedMediaRequestTriggerReasonsItem
from .types.media_retrieval_post_media_retrieval_request_body_inputs_item import (
    MediaRetrievalPostMediaRetrievalRequestBodyInputsItem,
)
from .types.media_retrieval_post_media_retrieval_request_body_media_type import (
    MediaRetrievalPostMediaRetrievalRequestBodyMediaType,
)

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class MediaClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawMediaClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawMediaClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawMediaClient
        """
        return self._raw_client

    def list_uploaded_media(
        self,
        *,
        vehicle_ids: str,
        start_time: str,
        end_time: str,
        inputs: typing.Optional[
            typing.Union[ListUploadedMediaRequestInputsItem, typing.Sequence[ListUploadedMediaRequestInputsItem]]
        ] = None,
        media_types: typing.Optional[
            typing.Union[
                ListUploadedMediaRequestMediaTypesItem, typing.Sequence[ListUploadedMediaRequestMediaTypesItem]
            ]
        ] = None,
        trigger_reasons: typing.Optional[
            typing.Union[
                ListUploadedMediaRequestTriggerReasonsItem, typing.Sequence[ListUploadedMediaRequestTriggerReasonsItem]
            ]
        ] = None,
        available_after_time: typing.Optional[str] = None,
        after: typing.Optional[str] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> MediaRetrievalListUploadedMediaResponseBody:
        """
        This endpoint returns a list of all uploaded media (video and still images) matching query parameters, with a maximum query range of one day. Additional media can be retrieved with the [Create a media retrieval request](https://developers.samsara.com/reference/postmediaretrieval) endpoint, and they will be included in the list after they are uploaded. Urls provided by this endpoint expire in 8 hours.

         <b>Rate limit:</b> 100 requests/min (learn more about rate limits <a href="https://developers.samsara.com/docs/rate-limits" target="_blank">here</a>).

        To use this endpoint, select **Read Media Retrieval** under the Safety & Cameras category when creating or editing an API token. <a href="https://developers.samsara.com/docs/authentication#scopes-for-api-tokens" target="_blank">Learn More.</a>


         **Submit Feedback**: Likes, dislikes, and API feature requests should be filed as feedback in our <a href="https://forms.gle/zkD4NCH7HjKb7mm69" target="_blank">API feedback form</a>. If you encountered an issue or noticed inaccuracies in the API documentation, please <a href="https://www.samsara.com/help" target="_blank">submit a case</a> to our support team.

        Parameters
        ----------
        vehicle_ids : str
            A filter on the data based on this comma-separated list of vehicle IDs and externalIds. You can specify up to 20 vehicles. Example: `vehicleIds=1234,5678,samsara.vin:1HGBH41JXMN109186`

        start_time : str
            A start time in RFC 3339 format. Millisecond precision and timezones are supported. (Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00).

        end_time : str
            An end time in RFC 3339 format. End time cannot be more than 24 hours after startTime. Millisecond precision and timezones are supported. (Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00).

        inputs : typing.Optional[typing.Union[ListUploadedMediaRequestInputsItem, typing.Sequence[ListUploadedMediaRequestInputsItem]]]
            An optional list of desired camera inputs for which to return captured media. If empty, media for all available inputs will be returned.

        media_types : typing.Optional[typing.Union[ListUploadedMediaRequestMediaTypesItem, typing.Sequence[ListUploadedMediaRequestMediaTypesItem]]]
            An optional list of desired media types for which to return captured media. If empty, media for all available media types will be returned. Possible options include: image, videoHighRes.

        trigger_reasons : typing.Optional[typing.Union[ListUploadedMediaRequestTriggerReasonsItem, typing.Sequence[ListUploadedMediaRequestTriggerReasonsItem]]]
            An optional list of desired trigger reasons for which to return captured media. If empty, media for all available trigger reasons will be returned. Possible options include: api, panicButton, periodicStill, rfidEvent, safetyEvent, tripEndStill, tripStartStill, videoRetrieval. videoRetrieval represents media captured for a dashboard video retrieval request.

        available_after_time : typing.Optional[str]
            An optional timestamp in RFC 3339 format that can act as a cursor to track which media has previously been retrieved; only media whose availableAtTime comes after this parameter will be returned. Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00

        after : typing.Optional[str]
             If specified, this should be the endCursor value from the previous page of results. When present, this request will return the next page of results that occur immediately after the previous page of results.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        MediaRetrievalListUploadedMediaResponseBody
            OK response.

        Examples
        --------
        from samsara import Samsara

        client = Samsara(
            token="YOUR_TOKEN",
        )
        client.media.list_uploaded_media(
            vehicle_ids="vehicleIds",
            start_time="startTime",
            end_time="endTime",
            available_after_time="availableAfterTime",
            after="after",
        )
        """
        _response = self._raw_client.list_uploaded_media(
            vehicle_ids=vehicle_ids,
            start_time=start_time,
            end_time=end_time,
            inputs=inputs,
            media_types=media_types,
            trigger_reasons=trigger_reasons,
            available_after_time=available_after_time,
            after=after,
            request_options=request_options,
        )
        return _response.data

    def get_media_retrieval(
        self, *, retrieval_id: str, request_options: typing.Optional[RequestOptions] = None
    ) -> MediaRetrievalGetMediaRetrievalResponseBody:
        """
        This endpoint returns media information corresponding to a retrieval ID. Retrieval IDs are associated to prior [media retrieval requests](https://developers.samsara.com/reference/postmediaretrieval). Urls provided by this endpoint expire in 8 hours.

         <b>Rate limit:</b> 100 requests/min (learn more about rate limits <a href="https://developers.samsara.com/docs/rate-limits" target="_blank">here</a>).

        To use this endpoint, select **Read Media Retrieval** under the Safety & Cameras category when creating or editing an API token. <a href="https://developers.samsara.com/docs/authentication#scopes-for-api-tokens" target="_blank">Learn More.</a>


         **Submit Feedback**: Likes, dislikes, and API feature requests should be filed as feedback in our <a href="https://forms.gle/zkD4NCH7HjKb7mm69" target="_blank">API feedback form</a>. If you encountered an issue or noticed inaccuracies in the API documentation, please <a href="https://www.samsara.com/help" target="_blank">submit a case</a> to our support team.

        Parameters
        ----------
        retrieval_id : str
            Retrieval ID associated with this media capture request. Examples: 2308cec4-82e0-46f1-8b3c-a3592e5cc21e

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        MediaRetrievalGetMediaRetrievalResponseBody
            OK response.

        Examples
        --------
        from samsara import Samsara

        client = Samsara(
            token="YOUR_TOKEN",
        )
        client.media.get_media_retrieval(
            retrieval_id="retrievalId",
        )
        """
        _response = self._raw_client.get_media_retrieval(retrieval_id=retrieval_id, request_options=request_options)
        return _response.data

    def post_media_retrieval(
        self,
        *,
        end_time: str,
        inputs: typing.Sequence[MediaRetrievalPostMediaRetrievalRequestBodyInputsItem],
        media_type: MediaRetrievalPostMediaRetrievalRequestBodyMediaType,
        start_time: str,
        vehicle_id: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> MediaRetrievalPostMediaRetrievalResponseBody:
        """
        This endpoint creates an asynchronous request to upload certain media from a device. The closest available media to the requested timestamp is returned. Images and high-res videos are supported; other types of media (e.g. hyperlapse, low-res) are planned to be supported in the future. Currently, only unblurred media is supported. If a device is offline, the requested media will be uploaded once it comes back online. Quota limits are enforced for media retrievals made through the API. The Create a media retrieval request response includes information about the media retrieval quota remaining for the organization. The media retrieval quota for the organization is reset at the beginning of each month.The quota is expressed using seconds of High Resolution video. 10 still images are equivalent to a 1 second of High Resolution footage.

         <b>Rate limit:</b> 100 requests/min (learn more about rate limits <a href="https://developers.samsara.com/docs/rate-limits" target="_blank">here</a>).

        To use this endpoint, select **Write Media Retrieval** under the Safety & Cameras category when creating or editing an API token. <a href="https://developers.samsara.com/docs/authentication#scopes-for-api-tokens" target="_blank">Learn More.</a>


         **Submit Feedback**: Likes, dislikes, and API feature requests should be filed as feedback in our <a href="https://forms.gle/zkD4NCH7HjKb7mm69" target="_blank">API feedback form</a>. If you encountered an issue or noticed inaccuracies in the API documentation, please <a href="https://www.samsara.com/help" target="_blank">submit a case</a> to our support team.

        Parameters
        ----------
        end_time : str
            An end time in RFC 3339 format. If endTime is the same as startTime, an image will be captured at startTime. Must be 1 second or more after startTime and no more than 60 seconds after startTime (Examples: 2019-06-13T19:08:55Z, 2019-06-13T19:08:55.455Z, OR 2015-09-15T14:00:42-04:00).

        inputs : typing.Sequence[MediaRetrievalPostMediaRetrievalRequestBodyInputsItem]
            A list of desired camera inputs for which to capture media. Only media with valid inputs (e.g. device has that input stream and device was recording at the time) will be uploaded. An empty list is invalid.

        media_type : MediaRetrievalPostMediaRetrievalRequestBodyMediaType
            The desired media type. If a video is requested, endTime must be after startTime. If an image is requested, endTime must be the same as startTime. Must be one of: image, videoHighRes. Examples: image, videoHighRes.  Valid values: `image`, `videoHighRes`

        start_time : str
            A start time in RFC 3339 format. Millisecond precision and timezones are supported. (Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00).

        vehicle_id : str
            Vehicle ID for which to initiate media capture. Examples: 1234

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        MediaRetrievalPostMediaRetrievalResponseBody
            OK response.

        Examples
        --------
        from samsara import Samsara

        client = Samsara(
            token="YOUR_TOKEN",
        )
        client.media.post_media_retrieval(
            end_time="2019-06-13T19:08:55Z",
            inputs=[
                "dashcamRoadFacing",
                "dashcamRoadFacing",
                "dashcamRoadFacing",
                "dashcamRoadFacing",
            ],
            media_type="image",
            start_time="2019-06-13T19:08:25Z",
            vehicle_id="1234",
        )
        """
        _response = self._raw_client.post_media_retrieval(
            end_time=end_time,
            inputs=inputs,
            media_type=media_type,
            start_time=start_time,
            vehicle_id=vehicle_id,
            request_options=request_options,
        )
        return _response.data


class AsyncMediaClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawMediaClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawMediaClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawMediaClient
        """
        return self._raw_client

    async def list_uploaded_media(
        self,
        *,
        vehicle_ids: str,
        start_time: str,
        end_time: str,
        inputs: typing.Optional[
            typing.Union[ListUploadedMediaRequestInputsItem, typing.Sequence[ListUploadedMediaRequestInputsItem]]
        ] = None,
        media_types: typing.Optional[
            typing.Union[
                ListUploadedMediaRequestMediaTypesItem, typing.Sequence[ListUploadedMediaRequestMediaTypesItem]
            ]
        ] = None,
        trigger_reasons: typing.Optional[
            typing.Union[
                ListUploadedMediaRequestTriggerReasonsItem, typing.Sequence[ListUploadedMediaRequestTriggerReasonsItem]
            ]
        ] = None,
        available_after_time: typing.Optional[str] = None,
        after: typing.Optional[str] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> MediaRetrievalListUploadedMediaResponseBody:
        """
        This endpoint returns a list of all uploaded media (video and still images) matching query parameters, with a maximum query range of one day. Additional media can be retrieved with the [Create a media retrieval request](https://developers.samsara.com/reference/postmediaretrieval) endpoint, and they will be included in the list after they are uploaded. Urls provided by this endpoint expire in 8 hours.

         <b>Rate limit:</b> 100 requests/min (learn more about rate limits <a href="https://developers.samsara.com/docs/rate-limits" target="_blank">here</a>).

        To use this endpoint, select **Read Media Retrieval** under the Safety & Cameras category when creating or editing an API token. <a href="https://developers.samsara.com/docs/authentication#scopes-for-api-tokens" target="_blank">Learn More.</a>


         **Submit Feedback**: Likes, dislikes, and API feature requests should be filed as feedback in our <a href="https://forms.gle/zkD4NCH7HjKb7mm69" target="_blank">API feedback form</a>. If you encountered an issue or noticed inaccuracies in the API documentation, please <a href="https://www.samsara.com/help" target="_blank">submit a case</a> to our support team.

        Parameters
        ----------
        vehicle_ids : str
            A filter on the data based on this comma-separated list of vehicle IDs and externalIds. You can specify up to 20 vehicles. Example: `vehicleIds=1234,5678,samsara.vin:1HGBH41JXMN109186`

        start_time : str
            A start time in RFC 3339 format. Millisecond precision and timezones are supported. (Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00).

        end_time : str
            An end time in RFC 3339 format. End time cannot be more than 24 hours after startTime. Millisecond precision and timezones are supported. (Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00).

        inputs : typing.Optional[typing.Union[ListUploadedMediaRequestInputsItem, typing.Sequence[ListUploadedMediaRequestInputsItem]]]
            An optional list of desired camera inputs for which to return captured media. If empty, media for all available inputs will be returned.

        media_types : typing.Optional[typing.Union[ListUploadedMediaRequestMediaTypesItem, typing.Sequence[ListUploadedMediaRequestMediaTypesItem]]]
            An optional list of desired media types for which to return captured media. If empty, media for all available media types will be returned. Possible options include: image, videoHighRes.

        trigger_reasons : typing.Optional[typing.Union[ListUploadedMediaRequestTriggerReasonsItem, typing.Sequence[ListUploadedMediaRequestTriggerReasonsItem]]]
            An optional list of desired trigger reasons for which to return captured media. If empty, media for all available trigger reasons will be returned. Possible options include: api, panicButton, periodicStill, rfidEvent, safetyEvent, tripEndStill, tripStartStill, videoRetrieval. videoRetrieval represents media captured for a dashboard video retrieval request.

        available_after_time : typing.Optional[str]
            An optional timestamp in RFC 3339 format that can act as a cursor to track which media has previously been retrieved; only media whose availableAtTime comes after this parameter will be returned. Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00

        after : typing.Optional[str]
             If specified, this should be the endCursor value from the previous page of results. When present, this request will return the next page of results that occur immediately after the previous page of results.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        MediaRetrievalListUploadedMediaResponseBody
            OK response.

        Examples
        --------
        import asyncio

        from samsara import AsyncSamsara

        client = AsyncSamsara(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.media.list_uploaded_media(
                vehicle_ids="vehicleIds",
                start_time="startTime",
                end_time="endTime",
                available_after_time="availableAfterTime",
                after="after",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.list_uploaded_media(
            vehicle_ids=vehicle_ids,
            start_time=start_time,
            end_time=end_time,
            inputs=inputs,
            media_types=media_types,
            trigger_reasons=trigger_reasons,
            available_after_time=available_after_time,
            after=after,
            request_options=request_options,
        )
        return _response.data

    async def get_media_retrieval(
        self, *, retrieval_id: str, request_options: typing.Optional[RequestOptions] = None
    ) -> MediaRetrievalGetMediaRetrievalResponseBody:
        """
        This endpoint returns media information corresponding to a retrieval ID. Retrieval IDs are associated to prior [media retrieval requests](https://developers.samsara.com/reference/postmediaretrieval). Urls provided by this endpoint expire in 8 hours.

         <b>Rate limit:</b> 100 requests/min (learn more about rate limits <a href="https://developers.samsara.com/docs/rate-limits" target="_blank">here</a>).

        To use this endpoint, select **Read Media Retrieval** under the Safety & Cameras category when creating or editing an API token. <a href="https://developers.samsara.com/docs/authentication#scopes-for-api-tokens" target="_blank">Learn More.</a>


         **Submit Feedback**: Likes, dislikes, and API feature requests should be filed as feedback in our <a href="https://forms.gle/zkD4NCH7HjKb7mm69" target="_blank">API feedback form</a>. If you encountered an issue or noticed inaccuracies in the API documentation, please <a href="https://www.samsara.com/help" target="_blank">submit a case</a> to our support team.

        Parameters
        ----------
        retrieval_id : str
            Retrieval ID associated with this media capture request. Examples: 2308cec4-82e0-46f1-8b3c-a3592e5cc21e

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        MediaRetrievalGetMediaRetrievalResponseBody
            OK response.

        Examples
        --------
        import asyncio

        from samsara import AsyncSamsara

        client = AsyncSamsara(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.media.get_media_retrieval(
                retrieval_id="retrievalId",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.get_media_retrieval(
            retrieval_id=retrieval_id, request_options=request_options
        )
        return _response.data

    async def post_media_retrieval(
        self,
        *,
        end_time: str,
        inputs: typing.Sequence[MediaRetrievalPostMediaRetrievalRequestBodyInputsItem],
        media_type: MediaRetrievalPostMediaRetrievalRequestBodyMediaType,
        start_time: str,
        vehicle_id: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> MediaRetrievalPostMediaRetrievalResponseBody:
        """
        This endpoint creates an asynchronous request to upload certain media from a device. The closest available media to the requested timestamp is returned. Images and high-res videos are supported; other types of media (e.g. hyperlapse, low-res) are planned to be supported in the future. Currently, only unblurred media is supported. If a device is offline, the requested media will be uploaded once it comes back online. Quota limits are enforced for media retrievals made through the API. The Create a media retrieval request response includes information about the media retrieval quota remaining for the organization. The media retrieval quota for the organization is reset at the beginning of each month.The quota is expressed using seconds of High Resolution video. 10 still images are equivalent to a 1 second of High Resolution footage.

         <b>Rate limit:</b> 100 requests/min (learn more about rate limits <a href="https://developers.samsara.com/docs/rate-limits" target="_blank">here</a>).

        To use this endpoint, select **Write Media Retrieval** under the Safety & Cameras category when creating or editing an API token. <a href="https://developers.samsara.com/docs/authentication#scopes-for-api-tokens" target="_blank">Learn More.</a>


         **Submit Feedback**: Likes, dislikes, and API feature requests should be filed as feedback in our <a href="https://forms.gle/zkD4NCH7HjKb7mm69" target="_blank">API feedback form</a>. If you encountered an issue or noticed inaccuracies in the API documentation, please <a href="https://www.samsara.com/help" target="_blank">submit a case</a> to our support team.

        Parameters
        ----------
        end_time : str
            An end time in RFC 3339 format. If endTime is the same as startTime, an image will be captured at startTime. Must be 1 second or more after startTime and no more than 60 seconds after startTime (Examples: 2019-06-13T19:08:55Z, 2019-06-13T19:08:55.455Z, OR 2015-09-15T14:00:42-04:00).

        inputs : typing.Sequence[MediaRetrievalPostMediaRetrievalRequestBodyInputsItem]
            A list of desired camera inputs for which to capture media. Only media with valid inputs (e.g. device has that input stream and device was recording at the time) will be uploaded. An empty list is invalid.

        media_type : MediaRetrievalPostMediaRetrievalRequestBodyMediaType
            The desired media type. If a video is requested, endTime must be after startTime. If an image is requested, endTime must be the same as startTime. Must be one of: image, videoHighRes. Examples: image, videoHighRes.  Valid values: `image`, `videoHighRes`

        start_time : str
            A start time in RFC 3339 format. Millisecond precision and timezones are supported. (Examples: 2019-06-13T19:08:25Z, 2019-06-13T19:08:25.455Z, OR 2015-09-15T14:00:12-04:00).

        vehicle_id : str
            Vehicle ID for which to initiate media capture. Examples: 1234

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        MediaRetrievalPostMediaRetrievalResponseBody
            OK response.

        Examples
        --------
        import asyncio

        from samsara import AsyncSamsara

        client = AsyncSamsara(
            token="YOUR_TOKEN",
        )


        async def main() -> None:
            await client.media.post_media_retrieval(
                end_time="2019-06-13T19:08:55Z",
                inputs=[
                    "dashcamRoadFacing",
                    "dashcamRoadFacing",
                    "dashcamRoadFacing",
                    "dashcamRoadFacing",
                ],
                media_type="image",
                start_time="2019-06-13T19:08:25Z",
                vehicle_id="1234",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.post_media_retrieval(
            end_time=end_time,
            inputs=inputs,
            media_type=media_type,
            start_time=start_time,
            vehicle_id=vehicle_id,
            request_options=request_options,
        )
        return _response.data
